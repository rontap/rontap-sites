<HTML>

<HEAD>
    <meta name="author" content="Rontap, Team Autism"/>
    <meta name="description" content="Graph Editor based on Mathematical Modell"/>
    <meta name="keywords" content="RTS NXT Graph Generator Graphene">
    <link rel="icon" href="../NXTJS/icons/graphisoft.png" type="image/png">
    <link rel="manifest" href="manifest.json">

    <!--importing essential data structures-->
    <script src="./node.class.js"></script>
    <script src="./graph.class.js"></script>
    <script src="../NXTJS/history.class.js"></script>

    <script src="../NXTJS/jsplus.js"></script>


    <title>Graphene Graph Drawer</title>
</HEAD>

<BODY class="module-sidebar" onkeydown="handleKeys(event)" onclick="deSelectRender(event)">
<div id="jumper">
    <div class="cat" onclick="location.reload()">
        <i class="material-icons">edit</i>
        <span>New Empty Graph<br>(default)</span>
    </div>
    <div class="cat" onclick="generator.showModal()">
        <i class="material-icons">scatter_plot</i>
        <span>Generate<br>using parameters</span>
    </div>
    <div class="cat" onclick="nxt.notify(3000,'Sorry, Imports are Unavabile.')">
        <i class="material-icons">archive</i>
        <span>Import<br>from a savefile</span>
    </div>
    <div class="cat" onclick="store.export()">
        <i class="material-icons">unarchive</i>
        <span>Export As<br>Graphene file</span>
    </div>
    <div class="cat" onclick="store.export('Image/Png')">
        <i class="material-icons">image</i>
        <span>Export As<br>Image</span>
    </div>
    <div class="cat" onclick="location.reload()">
        <i class="material-icons">clear</i>
        <span>Clear All<br>A fresh start</span>
    </div>


</div>
<style>
    #tue {
        position: fixed;
        left: 0;
        bottom: 30px;
        padding: 10px;
        width: 150px;
        height: 150px;
        border: 2px solid #222;
        z-index: 999;
    }
</style>
<script>
    const ws = new WebSocket("ws://localhost:4242")

    // ws.addEventListener("open", (event) => {
    //
    // });
    // ws.addEventListener("message", (event) => {
    //     console.log("Message from server ", event.data);
    // });

    window.onhashchange = function (hash) {
        console.log(hash, window.location.hash);
        $_GET("graph")
        $_GET("solution")
    }

    const FORCE_LSA = true;
    window.LSA_xdiff = [];

    function partial_succ_prev(arr, arrb, index) {
        const orig = arr[index];
        const succ = arr[index + 1];
        const newindex = arrb.findIndex(v => v === orig);
        return arrb.at(newindex - 1) == succ || arrb.at(newindex + 1) == succ
    }

    function proc_tue(tgraph, tpath) {
        const nthIndex = Number(tue_range.value);
        const val = tgraph;
        const procd = val.split("\n").map(val => val.split(" "))[0].filter(v => v)
        const pd = 80
        for (let i = 0; i < procd.length; i += 3) {
            const nd = new Node(Number(procd[i]) - 1, {y: Number(procd[i + 1]) * 4.5, x: Number(procd[i + 2]) * 4.5});
            console.log(nd, procd[i], procd[i + 1], procd[i + 2]);
            graph.addNode(nd)
        }
        setTimeout(function () {
            if (tue_fx.value) {
                const jspath = JSON.parse(tpath)
                const proce = jspath[nthIndex].map(Number);
                if (nthIndex > 0) {
                    const proceprev = jspath[nthIndex - 1].map(Number);
                    LSA_xdiff = [...graph.nodes].map(([k, val], i) => {
                        if (nthIndex >= jspath.length - 1) {
                            return true;
                        }
                        if (proce.length != graph.nodes.size) {
                            if (proce.includes(val.id)) {
                                return "#48F"
                            }
                            return "#999"
                        }

                        if (proce[i] == proceprev[i] ||
                            partial_succ_prev(proceprev, proce, i)) {
                            return "#26C"
                        } else {
                            return "#444"
                        }
                    })
                }
                //const proce = proceval.replace("[", "").replace("]", "").split(",").map(Number)
                console.log(proce, '<<')
                console.log(graph.nodes)
                for (let i = 0; i < proce.length - 1; i++) {
                    console.log(proce[i + 1])
                    graph.nodes.get(proce[i])?.edges?.set(proce[i + 1], Math.max(2, 20))
                }
                graph.nodes.get(proce[proce.length - 1])?.edges?.set(proce[0], 1)
                render(null, {which: 3});

            }
        }, 100)

    }

    var intval;
</script>
<div id="tue">
    <!--    <input id="tue_val"/>-->
    <!--    <input id="tue_fx"/>-->
    <!--    <button onclick="proc_tue(tue_val.value,tue_fx.value)">DO THING</button>-->
    <!--    <input type="input" value="0" min="0" max="999" id="tue_range" onchange="proc_tue(tue_val.value,tue_fx.value)"/>-->
    <!--    <button onclick="tue_range.value=Number(tue_range.value)+1;proc_tue(tue_val.value,tue_fx.value)">NEXT</button>-->
    <!--    <button onclick="if(intval||Number(tue_range.value)>=graph.nodes.length-1){clearInterval(intval)}else{intval = setInterval(function(){proc_tue(tue_val.value,tue_fx.value);tue_range.value++;},100)}">-->
    <!--        TIMELAPSE BABY-->
    <!--    </button>-->
</div>
<script>
    function transposemx(mx) {
        return mx[0].map((_, colIndex) => mx.map(row => row[colIndex]));
    }

    function load_tue() {
        const v = tue_val.value;
        const vv = tue_graph.value;
        const parsed = (v.split("\n").map(row => row.replace(/ +/g, " ").split(" ")))
        const route = JSON.parse(vv.replace(/'/g, '"')).map(e => e.split(","))
        parsed.slice(1).forEach(((el, i) => {
            const [StringID, Type, x, y, demand, ReadyTime, DueDate, ServiceTime, PartnerID] = el;
            const nd = new Node(StringID, {y: Number(y) * 12, x: Number(x * 12)}, undefined, {Type});
            graph.addNode(nd)
        }))


        for (let i = 0; i < route.length; i++) {
            for (let k = 0; k < route[i].length; k++) {
                if (route[i][k + 1] != undefined) {
                    console.log(route[i][k], route[i][k + 1])
                    graph.nodes.get(route[i][k])?.edges?.set(route[i][k + 1], "COLOR:" + i)
                }
            }
        }
        render(null, {which: 3});
        console.log(parsed, route)
    }
</script>
<div id="tue">
    GRAPH DISPLAY<br/>
    <textarea id="tue_val" placeholder="values">
        StringID     Type         x            y            demand       ReadyTime    DueDate      ServiceTime  PartnerID
D0           d            35.0         35.0         0.0          0.0          230.0        0.0          0
S0           f            35.0         35.0         0.0          0.0          230.0        0.0          0
S1           f            61.0         37.0         0.0          0.0          230.0        0.0          0
S2           f            74.0         39.0         0.0          0.0          230.0        0.0          0
S3           f            47.0         57.0         0.0          0.0          230.0        0.0          0
S4           f            57.0         65.0         0.0          0.0          230.0        0.0          0
S5           f            29.0         59.0         0.0          0.0          230.0        0.0          0
S6           f            34.0         71.0         0.0          0.0          230.0        0.0          0
S7           f            22.0         58.0         0.0          0.0          230.0        0.0          0
S8           f            7.0          61.0         0.0          0.0          230.0        0.0          0
S9           f            18.0         41.0         0.0          0.0          230.0        0.0          0
S10          f            5.0          39.0         0.0          0.0          230.0        0.0          0
S11          f            14.0         20.0         0.0          0.0          230.0        0.0          0
S12          f            0.0          26.0         0.0          0.0          230.0        0.0          0
S13          f            24.0         25.0         0.0          0.0          230.0        0.0          0
S14          f            26.0         6.0          0.0          0.0          230.0        0.0          0
S15          f            34.0         20.0         0.0          0.0          230.0        0.0          0
S16          f            41.0         5.0          0.0          0.0          230.0        0.0          0
S17          f            50.0         9.0          0.0          0.0          230.0        0.0          0
S18          f            61.0         14.0         0.0          0.0          230.0        0.0          0
S19          f            62.0         21.0         0.0          0.0          230.0        0.0          0
S20          f            74.0         30.0         0.0          0.0          230.0        0.0          0
C1           cd           41.0         49.0         -20.0        73.0         204.0        10.0         C65
C2           cp           35.0         17.0         7.0          18.0         147.0        10.0         C22
C3           cd           55.0         45.0         -9.0         76.0         165.0        10.0         C29
C4           cd           55.0         20.0         -31.0        73.0         195.0        10.0         C39
C5           cp           15.0         30.0         26.0         20.0         167.0        10.0         C38
C6           cp           25.0         30.0         3.0          49.0         158.0        10.0         C83
C7           cp           20.0         50.0         5.0          36.0         135.0        10.0         C47
C8           cd           10.0         43.0         -16.0        50.0         149.0        10.0         C82
C9           cp           55.0         60.0         16.0         47.0         156.0        10.0         C50
C10          cp           30.0         60.0         16.0         85.0         172.0        10.0         C70
C11          cd           20.0         65.0         -19.0        33.0         152.0        10.0         C62
C12          cd           50.0         35.0         -11.0        15.0         133.0        10.0         C21
C13          cp           30.0         25.0         23.0         79.0         208.0        10.0         C58
C14          cp           15.0         10.0         20.0         32.0         187.0        10.0         C91
C15          cp           30.0         5.0          8.0          30.0         152.0        10.0         C42
C16          cp           10.0         20.0         19.0         29.0         139.0        10.0         C96
C17          cd           5.0          30.0         -12.0        60.0         189.0        10.0         C18
C18          cp           20.0         40.0         12.0         47.0         136.0        10.0         C17
C19          cp           15.0         60.0         17.0         32.0         146.0        10.0         C63
C20          cp           45.0         65.0         9.0          79.0         182.0        0.0          C105
C21          cp           45.0         20.0         11.0         18.0         136.0        10.0         C12
C22          cd           45.0         10.0         -7.0         50.0         153.0        10.0         C2
C23          cd           55.0         5.0          -5.0         36.0         155.0        10.0         C41
C24          cd           65.0         35.0         -9.0         58.0         190.0        10.0         C73
C25          cp           65.0         20.0         6.0          56.0         186.0        10.0         C54
C26          cd           45.0         30.0         -9.0         87.0         186.0        10.0         C40
C27          cp           35.0         40.0         16.0         5.0          140.0        10.0         C31
C28          cp           41.0         37.0         16.0         6.0          136.0        10.0         C78
C29          cp           64.0         42.0         9.0          29.0         150.0        10.0         C3
C30          cp           40.0         60.0         21.0         25.0         132.0        10.0         C51
C31          cd           31.0         52.0         -16.0        17.0         138.0        10.0         C27
C32          cd           35.0         69.0         -9.0         67.0         186.0        10.0         C64
C33          cp           53.0         52.0         11.0         24.0         161.0        10.0         C68
C34          cd           65.0         55.0         -13.0        70.0         173.0        10.0         C76
C35          cp           63.0         65.0         8.0          54.0         178.0        10.0         C66
C36          cp           2.0          60.0         5.0          41.0         178.0        10.0         C49
C37          cd           20.0         20.0         -18.0        87.0         190.0        10.0         C44
C38          cd           5.0          5.0          -26.0        42.0         153.0        10.0         C5
C39          cp           60.0         12.0         31.0         33.0         186.0        10.0         C4
C40          cp           40.0         25.0         9.0          40.0         139.0        10.0         C26
C41          cp           42.0         7.0          5.0          43.0         160.0        10.0         C23
C42          cd           24.0         12.0         -8.0         25.0         158.0        10.0         C15
C43          cp           23.0         3.0          7.0          82.0         185.0        10.0         C97
C44          cp           11.0         14.0         18.0         31.0         144.0        10.0         C37
C45          cp           6.0          38.0         16.0         29.0         169.0        10.0         C60
C46          cd           2.0          48.0         -9.0         63.0         180.0        10.0         C88
C47          cd           8.0          56.0         -5.0         34.0         176.0        10.0         C7
C48          cp           13.0         52.0         36.0         65.0         192.0        0.0          C104
C49          cd           6.0          68.0         -5.0         73.0         152.0        10.0         C36
C50          cd           47.0         47.0         -16.0        75.0         182.0        10.0         C9
C51          cd           49.0         58.0         -21.0        36.0         149.0        10.0         C30
C52          cp           27.0         43.0         9.0          11.0         133.0        10.0         C90
C53          cp           37.0         31.0         14.0         51.0         148.0        10.0         C55
C54          cd           57.0         29.0         -6.0         90.0         197.0        10.0         C25
C55          cd           63.0         23.0         -14.0        69.0         189.0        10.0         C53
C56          cd           53.0         12.0         -25.0        76.0         190.0        10.0         C72
C57          cd           32.0         12.0         -10.0        48.0         163.0        10.0         C98
C58          cd           36.0         26.0         -23.0        84.0         210.0        10.0         C13
C59          cp           21.0         24.0         28.0         17.0         183.0        10.0         C89
C60          cd           17.0         34.0         -16.0        70.0         201.0        10.0         C45
C61          cp           12.0         24.0         13.0         29.0         132.0        10.0         C86
C62          cp           24.0         58.0         19.0         25.0         154.0        10.0         C11
C63          cd           27.0         69.0         -17.0        34.0         172.0        10.0         C19
C64          cp           15.0         77.0         9.0          46.0         165.0        10.0         C32
C65          cp           62.0         77.0         20.0         49.0         170.0        10.0         C1
C66          cd           49.0         73.0         -8.0         68.0         179.0        10.0         C35
C67          cd           67.0         5.0          -18.0        43.0         156.0        10.0         C75
C68          cd           56.0         39.0         -11.0        80.0         198.0        10.0         C33
C69          cp           37.0         47.0         6.0          12.0         137.0        10.0         C77
C70          cd           37.0         56.0         -16.0        48.0         198.0        10.0         C10
C71          cd           57.0         68.0         -23.0        39.0         148.0        10.0         C79
C72          cp           47.0         16.0         25.0         22.0         170.0        10.0         C56
C73          cp           44.0         17.0         9.0          30.0         135.0        10.0         C24
C74          cp           46.0         13.0         8.0          74.0         195.0        0.0          C101
C75          cp           49.0         11.0         18.0         27.0         141.0        10.0         C67
C76          cp           49.0         42.0         13.0         27.0         128.0        10.0         C34
C77          cd           53.0         43.0         -6.0         72.0         200.0        10.0         C69
C78          cd           61.0         52.0         -16.0        42.0         159.0        10.0         C28
C79          cp           57.0         48.0         23.0         47.0         146.0        10.0         C71
C80          cp           56.0         37.0         6.0          73.0         198.0        0.0          C103
C81          cp           55.0         54.0         26.0         57.0         140.0        0.0          C106
C82          cp           15.0         47.0         16.0         23.0         146.0        10.0         C8
C83          cd           14.0         37.0         -3.0         21.0         157.0        10.0         C6
C84          cd           11.0         31.0         -27.0        57.0         154.0        10.0         C94
C85          cp           16.0         22.0         41.0         44.0         147.0        10.0         C93
C86          cd           4.0          18.0         -13.0        49.0         148.0        10.0         C61
C87          cd           28.0         18.0         -2.0         61.0         134.0        10.0         C92
C88          cp           26.0         52.0         9.0          21.0         136.0        10.0         C46
C89          cd           26.0         35.0         -28.0        68.0         211.0        10.0         C59
C90          cd           31.0         67.0         -9.0         46.0         153.0        10.0         C52
C91          cd           15.0         19.0         -20.0        70.0         194.0        10.0         C14
C92          cp           22.0         22.0         2.0          18.0         159.0        10.0         C87
C93          cd           18.0         24.0         -41.0        60.0         199.0        10.0         C85
C94          cp           26.0         27.0         27.0         58.0         151.0        10.0         C84
C95          cp           25.0         24.0         20.0         14.0         143.0        10.0         C99
C96          cd           22.0         27.0         -19.0        89.0         190.0        10.0         C16
C97          cd           25.0         21.0         -7.0         92.0         183.0        10.0         C43
C98          cp           19.0         21.0         10.0         21.0         142.0        10.0         C57
C99          cd           20.0         26.0         -20.0        33.0         142.0        10.0         C95
C100         cp           18.0         18.0         17.0         51.0         195.0        0.0          C102
C101         cd           46.0         13.0         -8.0         74.0         195.0        10.0         C74
C102         cd           18.0         18.0         -17.0        51.0         195.0        10.0         C100
C103         cd           56.0         37.0         -6.0         73.0         198.0        10.0         C80
C104         cd           13.0         52.0         -36.0        65.0         192.0        10.0         C48
C105         cd           45.0         65.0         -9.0         79.0         182.0        10.0         C20
C106         cd           55.0         54.0         -26.0        57.0         140.0        10.0         C81
    </textarea>
    <textarea id="tue_graph" placeholder="graph">['D0,C29,C3,D0,', 'D0,C6,C83,C75,C67,D0,', 'D0,C40,C26,C7,C47,D0,', 'D0,C2,C22,C10,C70,D0,', 'D0,C53,C76,C34,C55,C39,C4,D0,', 'D0,C95,C59,C99,C89,C62,C11,D0,', 'D0,C45,C60,C98,C57,D0,', 'D0,C16,C96,C74,C101,D0,', 'D0,C41,C23,C15,C43,C42,C97,D0,', 'D0,C9,C50,D0,', 'D0,C30,C51,C20,C105,C33,C68,C80,C103,C25,C54,D0,', 'D0,C82,C18,C17,C8,C64,C32,D0,', 'D0,C5,C85,C92,C87,C14,C91,C38,C93,D0,', 'D0,C73,C21,C12,C28,C24,C78,D0,', 'D0,C27,C31,C88,C48,C104,C46,D0,', 'D0,C19,C36,C49,C63,C13,C58,D0,', 'D0,C61,C86,C44,C100,C102,C37,C72,C56,D0,', 'D0,C52,C90,C69,C94,C84,C77,D0,', 'D0,C79,C81,C106,C35,C71,C65,C66,C1,D0,']

</textarea>
    <button onclick="load_tue()">do stuff</button>
</div>

<holder>
    <h1 class="">Graphene </h1>&nbsp;

    <button real flat title="Convert the Graph  using Algorithms" onclick="$('body').classList.toggle('jump')"
            id="jumpC">
        <i class="material-icons">create</i>&nbsp; File...
    </button>


    <group style="vertical-align:6px;">
        <button real flat onclick="store.undo()"><i class="material-icons">undo</i>&nbsp;</button>
        <button real flat onclick="store.redo()"><i class="material-icons">redo</i>&nbsp;</button>
    </group>
    <!--group  style="vertical-align:6px;">
      <button title="Export Current Graph"real flat onclick="store.export();/*exportIt.showModal();*/"><i class="material-icons" >unarchive</i>&nbsp; Export</button>
      <!--button title="Import Current Graph"real flat  style="border-left:1px solid #333" onclick="importIt.showModal();"><i class="material-icons" >archive</i>&nbsp; Import</button>

    </group-->


    <button real flat title="Convert the Graph  using Algorithms"
            onclick="/*convertIt.showModal();*/$('body').classList.toggle('node-selection')">
        <i class="material-icons">swap_horizontal_circle</i>&nbsp; Convert
    </button>

    <!--button real flat title="Clear everything and reload"err onclick="store.flush(true)">
      <i class="material-icons" >clear</i>&nbsp; Clear All</button-->

    <button real flat title="Switch to/from fullscreen"
            onclick="toggleFullscreen();isFullscreen() ?fst.innerHTML='fullscreen':fst.innerHTML='fullscreen_exit'">
        <i class="material-icons" id="fst">fullscreen</i>&nbsp; Fullscreen
    </button>

    <button real flat title="Generate a Custom Graph" onclick="generator.showModal()">
        <i class="material-icons" id="gener">scatter_plot</i>&nbsp; Generate
    </button>

    <button real flat title="About Graphene" onclick="about.showModal()">
        <i class="material-icons" id="">info</i>&nbsp; About
    </button>


    <button real flat id="statusHolder" disabled>...</button>
</holder>
<dialog nxt id="about" ondblclick="this.close()">
    <h1 class="covered blue-400 white-text" id="projectName" style="margin-bottom:0px;">Graphene - v12</h1>
    <div id="diagMenu">
        <a href="#aboutText">About</a>
        <a href="#references">References</a>
        <a href="#updatesw">Update</a>
        <a href="#references">Developer</a>
    </div>
    <div id="diagScrollable">


        <br>
        <h2 id="aboutText"> Graph Generator and Editor</h2>
        <table>
            <tr>
                <td>Coding:</td>
                <td>Aron Tatai</td>
            </tr>
            <tr>
                <td>Additional Coding:</td>
                <td>Mate Cser</td>
            </tr>
            <tr>
                <td>Help & Testing:</td>
                <td>Mate Csikos-Nagy, Agoston Csehi, Aron Tatai</td>
            </tr>
        </table>
        <br>
        Created from October 2018<br>
        Created in Javascript using NXT.js and coffee.<br><br>
        <hr>

        <a nxt href="https://github.com/rontap/rts-nxt/tree/master/graphs"> Source Code </a> |
        <a nxt href="http://rontap.netne.net"> Website Index</a> |
        <a nxt href="https://github.com/rontap/rts-nxt/tree/master/graphs"> Graph API</a> |

        <div id="references"><br></div>
        <h2>References</h2>
        <br><br><br><br><br><br><br><br>
        <br><br><br><br><br><br><br><br>
        <div id="updatesw"><br></div>
        <h2>Offline / Webapp</h2>
        This application can be viewed and used even if offline.<br>
        App version: <a id="appver">[not loaded]</a><br><br>
        If you like it, wy not <a nxt>add to your homescreen</a>.<br><br>

        <a nxt>Force Update</a> |
        <a nxt>Disable Webapp</a> |
        <a nxt>Clear Storage</a>
        <br><br><br><br><br><br><br><br>
        <a nxt href="ver.html"> Version History</a>

    </div>
</dialog>
<dialog nxt id="generator" ondblclick="this.close();">

    <h1 class="covered" style="margin-bottom:0px;">Generate a Graph</h1>

    <!--span class="elem">
      <span>Seed</span>
      <input  flat real  value="123456789">
    </span-->
    <span class="elem">
    <span>Number of Nodes</span>
    <input nxt value="20" type="range" min=0 max=100 id="frqN">
  </span>
    <span class="elem">
    <span>Number of Connections</span>
    <input nxt value="20" type="range" min=0 max=100 id="frqC">
  </span>
    <span class="elem">
    <span>Node Weight Randomness</span>
    <input nxt value="0" type="range" min=0 max=35 id="weiN">
  </span>
    <span class="elem">
    <span>Connection Weight Randomness</span>
    <input nxt value="1" type="range" min=0 max=30 id="weiC">
  </span>
    <span class="elem">
    <span>Generate Names</span>
    <toggle nxt value="1" onclick="this.classList.toggle('on')" checkbox id="randNamesGen"></toggle>
  </span>
    <i id="loadInd" class="material-icons">data_usage</i>
    <action color class="green-500">
        <button flr onclick="genGraphFromInput();">GENERATE</button>
        <button warn onclick="genGraphRandomly();">EXIT</button>
        <button warn onclick="generator.close();">RANDOMIZE</button>
    </action>
</dialog>
<dialog nxt id="convertIt">

    <h1 class="covered">Convert using Graph Algorithms</h1>
    <!--br>
      <radio name="pol">Disjktra</radio><br>
      <radio name="pol">Prims</radio><br>
      <radio name="pol">Something</radio><br>
      <radio name="pol">Else</radio><br-->
    Unavabile for now. Sorry.
    <action color class="indigo-500">
        <button onclick="convertIt.close();" default>HELP</button>
        <button flr onclick="convertIt.close();">CONVERT</button>
        <button flr warn onclick="convertIt.close();">EXIT</button>
    </action>
</dialog>
<dialog nxt id="exportIt">

    <h1 class="covered">Export As:</h1>

    Select a Source for your Export:<br><br>
    <radio name="imp" onclick=DOWNLOAD='Save' checked="true">As Save File</radio>
    <br>
    <radio name="imp" onclick=DOWNLOAD='Csv'>As CSV File</radio>
    <br>
    <radio name="imp" onclick=DOWNLOAD='Image/Png' checked="true">As PNG Image</radio>
    <radio name="imp" onclick=DOWNLOAD='Image/Jpg' checked="true">As JPG Image</radio>

    <br>
    <action color class="blue-500">
        <button flr onclick="exportIt.close();store.export();">EXPORT</button>
        <button warn onclick="exportIt.close();">CLOSE</button>
    </action>
</dialog>

<dialog nxt id="importIt">

    <h1 class="covered">Import Node</h1>
    <br>
    Select a Source for your Import or Export:<br><br>
    <radio name="imp" checked="true">File</radio>
    <br>
    <action color class="orange-500">
        <button onclick="importIt.close();store.import();" default>IMPORT</button>
        <button flr warn onclick="importIt.close();">CLOSE</button>
    </action>
</dialog>

<span id="canvHolder">
  <canvas id="canvBg"></canvas>
  <canvas id="canvOverlay"></canvas>
  <canvas id="canv" onmousedown="render('click',event)"
          onmouseup="render('up',event)" onmousemove="render('down',event)"></canvas>
</span>


<div module="sidebar" id="sidebarProp" onmouseup="this.classList.add('open');">
    <h2 id="sidebarPropDrag">Properties</h2>
    <i class="material-icons" style="" dragger>drag_indicator</i>
    <i id="lineClose" class="material-icons" onclick="minimiseFactory(this.parentElement.id)" closer>vertical_align_bottom</i>
    <div id="properties"></div>
    <div class="bottomfix" b3>
        <button warn onclick="graph.nodes.delete( clickArea.id );closeWindow('sidebarProp');">Delete<br>Node</buton>
            <button onclick="copyProps( propEl )">Copy Props</button>
            <button onclick="pastePropsToCurrentNode()" disabled id="pasteProps">Paste Props</button>
    </div>
</div>

<group module="action" id="action" style="margin-left:0px">
    <button id="action-place-mode" real flat onclick="switchMode('Place')" data-text="Add or Modify Nodes and Links">
        <i class="material-icons">touch_app</i>
    </button>
    <button id="action-move-mode" real flat onclick="switchMode('Move')" data-text="Move Field">
        <i class="material-icons">control_camera</i>
    </button>
    <button id="action-search-mode" real flat onclick="switchMode('Search')" data-text="Routes and Subgraphs">
        <i class="material-icons">swap_horizontal_circle</i>
    </button>
    <button real flat onclick="switchMode('Place')" data-text="???">
        <i class="material-icons">outlined_flag</i>
    </button>
    <i class="material-icons" dragger id="actionDrag">drag_indicator</i>
</group>


<div module="sidebar" id="line" onmouseup="this.classList.add('open');" style="height:251px">
    <h2>Line </h2>
    <i id="lineDrag" class="material-icons" style="margin-left:218px" dragger>drag_indicator</i>
    <i id="lineClose" class="material-icons" onclick="minimiseFactory(this.parentElement.id)" closer>vertical_align_bottom</i>
    <div id="linkProperties">
        <div id="linkRef" style="margin-top:-15px">&nbsp;</div>
        Line Weight:
        <br>

        <input type="range" nxt value="10" max="50" min="0" id="rangeLP"
               onchange="sidebar.updateLineWidth(this.value)"/>
        <input id="textLP" type="number" nxt value='10'
               onchange="sidebar.updateLineWidth(this.value)"/><span> </span><br><br>
        <switch checked="true"><span>Bidirectional</span><span>Directed</span></switch>
        <br>


        <div class="bottomfix" b1>
            <button warn onclick="sidebar.removeCurrLine();">Delete Connection</buton>
        </div>
    </div>
</div>

<div module="sidebar" id="path" onmouseup="this.classList.add('open');" style="height:251px">
    <h2>Path </h2>
    <i id="pathDrag" class="material-icons" style="margin-left:218px" dragger>drag_indicator</i>
    <i id="pathClose" class="material-icons" onclick="minimiseFactory(this.parentElement.id)" closer>vertical_align_bottom</i>
    <div id="pathProperties">
        <div id="pathkRef" style="margin-top:-15px">&nbsp;</div>
        path Weight:
        <br>

        <input type="range" nxt value="10" max="50" min="0" id="rangeLP"
               onchange="sidebar.updateLineWidth(this.value)"/>
        <input id="textLP" type="number" nxt value='10'
               onchange="sidebar.updateLineWidth(this.value)"/><span> </span><br><br>
        <switch checked="true"><span>Bidirectional</span><span>Directed</span></switch>
        <br>


        <div class="bottomfix" b1>
            <button warn onclick="sidebar.removeCurrLine();">Delete Connection</buton>
        </div>
    </div>
</div>

<!--div module="sidebar" id="welcome" onmouseup="this.classList.add('open');" style="height:270px;width:480px;">
  <h2 style="margin-top:10px" >Welcome </h2>
  <i id="welcomeDrag" class="material-icons" style="margin-left:448px" dragger>drag_indicator</i>
  <div id="welcomeProp">



  </div>
</div-->


<div module="sidebar" id="distance" style="width:350px;" onclick="this.classList.add('open','on')">
    <h2 id="distanceDrag">Measure Distance</h2>
    <i class="material-icons" style="margin-left:320px" dragger>drag_indicator</i>
    Measure Distance Between Two Nodes<br>
    <i>Drag and Drop from a Node to another.</i>
</div>


<div module="sidebar" id="multiselect" style="" onmouseup="this.classList.add('open','on')">
    <h2 id="multiselectDrag">LIST</h2>
    <i class="material-icons" style="margin-left:270px" dragger>drag_indicator</i>
    <i id="msClose" class="material-icons" style="margin-left: 225px;" onclick="minimiseFactory('multiselect')" closer>vertical_align_bottom</i>
    <select nxt flat id="msTypeSelect">
        <option>from Selection</option>
        <option>show All</option>
    </select>

    <br>
    Ctrl+Click to select multiple.
    <br>

    <div id="msCurrList">currList
    </div>
    <div class="bottomfix" b3 id="msbottomfix">
        <button onclick="graph.nodes.delete( clickArea.id );closeWindow('sidebarProp');">Add<br>Nodes...</buton>
            <button>Invert<br>Selection</button>
            <button disabled>Hmm<br>Props</button>
            <button>Cancel<br>Selection</button>
    </div>
</div>

<div module="sidebar" id="textStyle" style="width:280px;height:380px;" onmouseup="this.classList.add('open');">
    <h2 id="textStyleDrag">Text Style</h2>
    <i class="material-icons" style="" dragger>drag_indicator</i>
    <i id="lineClose" class="material-icons" onclick="minimiseFactory(this.parentElement.id)" closer>vertical_align_bottom</i><br>
    Node Text Styling<br><br>
    <div id="">
  <span class="elem">
    <span>Font Size</span>
    <input id="rangeFontLP" step=".5" double type="range" nxt="" value="12" max="40" min="2"
           onchange="sidebar.setFontSize(this.value)">
    <input id="textFontLP" double type="number" value="12" onchange="sidebar.setFontSize(this.value)">
  </span>
        <span class="elem">
    <span>Rotation</span>
    <input double type="range" nxt="" value="10" max="50" min="0" onchange="sidebar.(this.value)">
    <input double type="number" value="10" onchange="sidebar.(this.value)">
  </span>
        <span class="elem">
    <span>Default Text</span>
    <input real flat onchange="textExtra[0]=this.value;render(null,{which:3})" value="" placeholder="if no text is set">
  </span>
        <span class="elem">
    <span>Prefix Text</span>
    <input real flat onchange="textExtra[1]=this.value;render(null,{which:3})" value="" placeholder="before all text">
  </span>
        <span class="elem">
    <span>Suffix Text</span>
    <input real flat onchange="textExtra[2]=this.value;render(null,{which:3})" value="" placeholder="after all text">
  </span>

        <span class="elem">
      <span>Font Color</span>
      <input real flat type="color" id="fontColor" onchange="render(null,{which:3})">
    </span>
    </div>
</div>

<div module="sidebar" id="viewer" onmouseup="this.classList.add('on')" style="height:530px">
    <h2 id="viewerDrag">View and<br> highlighting</h2>
    <i class="material-icons" style="" dragger>drag_indicator</i>
    <i id="viewerClose" class="material-icons" onclick="minimiseFactory(this.parentElement.id)" closer>vertical_align_bottom</i>

    <span class="elem">
      <span>Node Colors:</span>
      <select real flat onchange="updateSelMode(this.value)">
      <option value="Subgraph" default>Subgraphs</option>
      <option value="NodeWeight">Node Weight</option>
      <option value="NodeConnection">Node Connections</option>
      <option value="Random">Random Coloring</option>
      <option value="NoColoring">No Coloring</option>
    </select>
  </span>


    <span class="elem">
    <span>Connection weight:</span>
    <select real flat onchange="updateConnectionMode(this.value)" class="elem">
      <option value="Manual" default>Manual Weight</option>
      <option value="ConnectionWeight">Calculate From Distance</option>

    </select>
  </span>
    <span class="elem">
      <span>Node Weight:</span>
      <select real flat onchange="updateNodeConnectionMode(this.value)" class="elem">
        <option value="Manual" default>Manual Weight</option>
        <option value="ConnectionWeight">Calculate From Connections</option>

      </select>
  </span>
    <span class="elem">
    <span>Connection Color:</span>
    <select real flat onchange="updateNodeConnectionHighlight(this.value)" class="elem">
      <option value="Default" default>Default (Black)</option>
      <option value="FromWeight">Calculate From Weight</option>
      <option value="HighlightCircles">Highlight Circles</option>
      <option value="SE">[not implemented]</option>

    </select>
</span>
    <span class="elem">
    <span>Background Color</span>
    <input real flat type="color" onchange="canvBgColor=this.value;render(null,{which:3})" value="#ffffff">
  </span>

    <span class="elem" id="saveElems"><br>
    Changes are not saved, only highlighed.<br> <button nxt>Apply Changes to elements</button>
  </span>
</div>

<div module="sidebar" id="treeObj" onmouseup="this.classList.add('on')" style="height:530px">
    <h2 id="treeObjDrag">TREE</h2>
    <i class="material-icons" style="" dragger>drag_indicator</i>
    <i id="treeObjClose" class="material-icons" onclick="minimiseFactory(this.parentElement.id)" closer>vertical_align_bottom</i>
    <br>
    <select id="treeColouring">
        <option disabled selected value="fromGlobal">Default (Inherit)</option>
        <option value="fromGlobal">Inherit from Global Settins</option>
        <option value="fromDST">From distance to root</option>
    </select>
    Zsaaa<br>
</div>


</div>

<div id="selectNode">
    <b>Select a Node for</b>
    <c> to convert its subgraph to tree.</c>
    <b>Selected: </b>
    <c id="propElDesc">None.</c>
    <button id="confirmNode" onclick="toTree();">Convert <span id="convertToText">Selected</span></button>
    <i class="material-icons" onclick="$('body').classList.remove('node-selection') ">clear</i>

</div>


<footer id="docFooter">
    <div id="footerBarHolder"></div>
    <div id="shortcutHelp">Click to add a new Node</div>
</footer>

<span id="clippyHolder">
<img src="resources/clippy.png" id="clippy">
<div id="clippyHelp">
  It looks like you're trying to<br>
  Create a New Graph. Let me help you!<br>
  <button>Click anywhere to create a new node</button>
  <button>Connect to nodes to create an edge</button>
  <button>Try using ALT/DEL to move and delete edges</button>
  <button>Keep in mind that this is a homemade proof-of-concept</button>
  <button onclick="clippyHolder.innerHTML=''">Close Clippy :(</button>
</div>
</span>
</BODY>
<script src="../NXTJS/material-colors.js"></script>

<script src="./js/main.js"></script>
<script src="./js/window.js"></script>
<script src="./js/struct.js"></script>
<script src="./js/render.js"></script>
<script src="./js/sidebar.js"></script>
<script src="./js/keyboard.js"></script>
<script src="./js/dnd.js"></script>
<script src="./js/generator.js"></script>
<script src="./js/circle.js"></script>
<script src="./js/multi.js"></script>
<script src="./js/text.js"></script>
<script src="./js/convert.js"></script>

<link rel="stylesheet" href="../NXTJS/design.css">
<link rel="stylesheet" href="../NXTJS/elements.css">
<link rel="stylesheet" href="../NXTJS/input.css">
<link rel="stylesheet" href="../xfiles/xfiles-ui.css">

<link rel="stylesheet" href="modules.css">
<link rel="stylesheet" href="main.css">
<link rel="stylesheet" href="dnd.css">
<link rel="stylesheet" href="jumper.css">
<link rel="stylesheet" href="mediaquery.css">

<script src="../NXTJS/design-input.js"></script>
<script src="service-manager.js" type="text/javascript"></script>

<script>
    localStorage['' + NAME + VERSION + 'MainStorage'] !== undefined ? store.load() : store.init();

    nxt.location = "../NXTJS/";
    nxt.notify();
</script>
</HTML>
